juju deploy ceph-mon -n 3   --constraints tags=mon --config fsid='dbdb3df0-cd33-11ef-9320-1588ee30deb4'   


juju run ceph-osd/0 stop osds=all
juju run ceph-osd/1 stop osds=all
juju run ceph-osd/2 stop osds=all



systemctl stop ceph-mon@ceph-mon-4.service
systemctl stop ceph-mgr@ceph-mon-4.service


systemctl stop ceph-mon@ceph-mon-2.service
systemctl stop ceph-mgr@ceph-mon-2.service

systemctl stop ceph-mon@ceph-mon-5.service
systemctl stop ceph-mgr@ceph-mon-5.service


//get script from garr and run garr.sh

[mon.]
        key = AQCvlX1nBT3NABAAQOxs4voGQdxbaj09VZ2OhQ==
        caps mon = "allow *"
[client.admin]
        key = AQDJlX1nZyEjBxAA7hS7RSzXQTzxBGpjzRI6iw==
        caps mds = "allow *"
        caps mgr = "allow *"
        caps mon = "allow *"
        caps osd = "allow *"
[mgr.ceph-mon-4]
        key = AQDMlX1nY5y/GRAAhbtXx05hTTr0xR8ayr99Ug==
        caps mds = "allow *"
        caps mon = "allow profile mgr"
        caps osd = "allow *"
[mgr.ceph-mon-2]
        key = AQDKlX1nY2cEHBAARatScT0tJeyrOQ+PyJZAMA==
        caps mds = "allow *"
        caps mon = "allow profile mgr"
        caps osd = "allow *"
[mgr.ceph-mon-5]
        key = AQDKlX1ncO+iHxAABmlcIx7oXY1dLwbmFky6dw==
        caps mds = "allow *"
        caps mon = "allow profile mgr"
        caps osd = "allow *"


copy the above to a file name keyring 


juju scp -- -r mon-store keyring ceph-mon/4:/tmp
juju scp -- -r mon-store keyring ceph-mon/5:/tmp
juju scp -- -r mon-store keyring ceph-mon/6:/tmp




ceph-monstore-tool /tmp/mon-store/ rebuild --keyring /tmp/keyring --mon-ids ceph-mon-4 ceph-mon-5 ceph-mon-2

//run the above in all 3 mons 


mv /var/lib/ceph/mon/ceph-ceph-mon-4/store.db /var/lib/ceph/mon/ceph-ceph-mon-4/store.db.bak
cp -r /tmp/mon-store/store.db /var/lib/ceph/mon/ceph-ceph-mon-4/store.db
chown ceph:ceph -R /var/lib/ceph/mon/ceph-ceph-mon-4/store.db


mv /var/lib/ceph/mon/ceph-ceph-mon-2/store.db /var/lib/ceph/mon/ceph-ceph-mon-2/store.db.bak
cp -r /tmp/mon-store/store.db /var/lib/ceph/mon/ceph-ceph-mon-2/store.db
chown ceph:ceph -R /var/lib/ceph/mon/ceph-ceph-mon-2/store.db


mv /var/lib/ceph/mon/ceph-ceph-mon-5/store.db /var/lib/ceph/mon/ceph-ceph-mon-5/store.db.bak
cp -r /tmp/mon-store/store.db /var/lib/ceph/mon/ceph-ceph-mon-5/store.db
chown ceph:ceph -R /var/lib/ceph/mon/ceph-ceph-mon-5/store.db





systemctl start ceph-mon@ceph-mon-4.service
systemctl start ceph-mgr@ceph-mon-4.service


systemctl start ceph-mon@ceph-mon-2.service
systemctl start ceph-mgr@ceph-mon-2.service

systemctl start ceph-mon@ceph-mon-5.service
systemctl start ceph-mgr@ceph-mon-5.service




juju run ceph-osd/0 start osds=all
juju run ceph-osd/1 start osds=all
juju run ceph-osd/2 start osds=all




15.15.0.77 15.15.0.78 15.15.0.79 
